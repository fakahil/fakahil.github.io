<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>How to do model fitting in Python | Fatima Kahil</title>
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/poole.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/lanyon.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://fakahil.github.io/coding/how-to-do-model-fitting-in-python/index.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Fatima Kahil">
<meta property="og:site_name" content="Fatima Kahil">
<meta property="og:title" content="How to do model fitting in Python">
<meta property="og:url" content="https://fakahil.github.io/coding/how-to-do-model-fitting-in-python/index.html">
<meta property="og:description" content="Curve fitting - How?¶






In this project, I will show the different libraries and methods to do curve fitting with Python. These methods differ in the way the objective function and Jacobian matrix">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-04-04T20:21:57+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../blog/">Blog</a>
        <a class="sidebar-nav-item" href="../../journal/">Journal</a>
        <a class="sidebar-nav-item" href="../">Coding</a>
        <a class="sidebar-nav-item" href="../../sunrise/">Sunrise</a>
        <a class="sidebar-nav-item" href="../../solo/">Solar Orbiter</a>
        <a class="sidebar-nav-item" href="../../talks/">Talks &amp; Posters</a>
        <a class="sidebar-nav-item" href="../../arabic/">المدونة</a>
        <a class="sidebar-nav-item" href="../../about-me/">Contact</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://fakahil.github.io/" title="Fatima Kahil" rel="home">Fatima Kahil</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="#" class="u-url">How to do model fitting in Python</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Fatima Kahil</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="post-date published dt-published" datetime="2020-04-04T20:21:57.256510+02:00" itemprop="datePublished" title="2020-04-04 20:21">2020-04-04 20:21</time></a></p>
        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Curve-fitting---How?">Curve fitting - How?<a class="anchor-link" href="index.html#Curve-fitting---How?">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="In-this-project,-I-will-show-the-different-libraries-and-methods-to-do-curve-fitting-with-Python.-These-methods-differ-in-the-way-the-objective-function-and-Jacobian-matrix-are-defined,-in-addition-to-some-other-capabilities.">In this project, I will show the different libraries and methods to do curve fitting with Python. These methods differ in the way the objective function and Jacobian matrix are defined, in addition to some other capabilities.<a class="anchor-link" href="index.html#In-this-project,-I-will-show-the-different-libraries-and-methods-to-do-curve-fitting-with-Python.-These-methods-differ-in-the-way-the-objective-function-and-Jacobian-matrix-are-defined,-in-addition-to-some-other-capabilities.">¶</a>
</h4>
<h4 id="For-the-purpose-of-illustrating-an-example,-I-will-introduce-a-limb-model-which-I-have-been-working-on-during-my-PhD.">For the purpose of illustrating an example, I will introduce a limb model which I have been working on during my PhD.<a class="anchor-link" href="index.html#For-the-purpose-of-illustrating-an-example,-I-will-introduce-a-limb-model-which-I-have-been-working-on-during-my-PhD.">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## importing the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="kn">as</span> <span class="nn">m</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>

 <span class="n">y</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
 <span class="k">return</span> <span class="n">y</span>

<span class="c1">## Introducing the model to be used later for the fitting</span>

<span class="k">def</span> <span class="nf">SL_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">w3</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">):</span>

  <span class="n">f</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">w1</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="o">+</span><span class="n">w2</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span><span class="o">+</span><span class="n">w3</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w1</span><span class="o">-</span><span class="n">w2</span><span class="o">-</span><span class="n">w3</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">f</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-first-method-we-will-use-is-via-scipy.optimize.curve_fit">The first method we will use is via <strong><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a></strong><a class="anchor-link" href="index.html#The-first-method-we-will-use-is-via-scipy.optimize.curve_fit">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#This is the jacobian matrx, which is the derivative of the fitting function with respect to every free parameter</span>
<span class="k">def</span> <span class="nf">DF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">w3</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">):</span>
 <span class="n">dfw1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">dfw2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">dfw3</span> <span class="o">=</span>  <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">dfs1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">dfs2</span> <span class="o">=</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">dfs3</span> <span class="o">=</span> <span class="n">w3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">s3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dfw1</span><span class="p">,</span><span class="n">dfw2</span><span class="p">,</span><span class="n">dfw3</span><span class="p">,</span><span class="n">dfs1</span><span class="p">,</span><span class="n">dfs2</span><span class="p">,</span><span class="n">dfs3</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## Loading the data:</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/home/fatima/Desktop/project_3/"</span>
<span class="nb">file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">'limb_profile_av_norm_shifted'</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## plotting the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'ggplot'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Arcseconds'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Normalized intensity'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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5GQAPvzwQ+644w7GjRtHTU0NL774Ilu2bOG+++4jOTmZtWvXYozhvffeo7KykqeeeoqoqCg2bdpEdHQ04C/jpKQknnjiCfbv38+UKVNITU3lvPPO46OPPuKVV17hN7/5Dbm5uXzzzTd4vV5qamp48MEHGTJkCHfddRerV6/moYceYsqUKWRmZgKwcOFCxo8fT5cuXZgxYwYvv/wyN998M7t372bq1KmMGTOGgoIC/vrXv/L3v/+dwYMHA/Dyyy/Tt29fJk6cSE1NDRs2bHDnD14kjOgQvUiYWb16NSUlJQwcOJCcnBzS09P58MMP617v378/3bt3x+Px4PP5+Mc//sGoUaNISUnB4/Fw0kknERUVhdfrZc+ePWzbtg2Px0NOTg7x8fGUl5ezbNkyRo0aRWxsLElJSVx00UUsXLgQgHfffZdLL72Url27YowhIyODtm3bsnbtWqqqqhg+fHjdXnZ+fn69bKeddhpdu3bF6/Vy5plnsmnTJgCWLVtGdnY2AwYMwOfzcdFFF9VtsAD4fD527NjBzp07iY6Opnv37qH5wxYJY9qDFwkz7733Hn369CExMRGAM888s26PHiA1NbVu3YqKCqqrq+sOgx9u8ODBlJaW8thjj1FZWclZZ53FFVdcQUlJCbW1tfUeimStrXvfkpIS0tPTj3i/nTt3kpaWVncYH6Bt27aUlZXVzR9e2jExMVRVVdX97OG5jTH15q+++mpefvllxo8fT0JCAhdffHHYPlRHJFRU8CJh5MCBA3z00Uc4jsN1110H+J+hvnfv3rq94UNPYgNo3bo1UVFRbNu2jc6dO9d7L5/Px+WXX87ll1/O9u3beeCBB8jMzOTUU0/F5/Mxa9YsvF7vERnS0tL45ptvjljepk0bSkpKcBynruRLSkpo3779944rOTmZ0tLSunlrbb355ORkrr/+esB/BOPee++lZ8+eR91wERE/HaIXCSP//ve/8Xg8PProozz88MM8/PDDPProo/To0YMPPvjgiPU9Hg9DhgzhxRdfpKysDMdxWLNmDdXV1axcuZKvvvoKx3GIj4/H5/NhjKFNmzb07duXF198kcrKShzHYdu2baxatQqAc889l7/85S9s2LABay3btm1jx44ddOvWjZiYGN58801qamr47LPPWLJkCWecccb3jis/P5/Nmzfzr3/9i9raWubNm0d5eXnd6x999FFd4SckJAD1N2RE5EjagxcJI++//z5DhgwhLS2t3vILLriA2bNnc/LJJx/xMz/5yU/44x//yB133EFVVRWdO3euOzHv2WefpaysjNjYWAYOHFh3UtsNN9zASy+9xC233MK+fftIT0/n0ksvBWDgwIFUVFTw+OOPU1ZWRrt27bjhhhto27Yt48aN47nnnuO1114jJSWFG264gQ4dOnzvuBITE7nllluYPXs2M2fOZPDgwZx00kl1r69fv57nn3+eyspKkpOTueaaa476MYGIfEvPgxcREYlAOkQvIiISgVTwIiIiEUgFLyIiEoFU8CIiIhFIBS8iIhKBVPAiIiIRSAUvIiISgVTwIiIiEUgFLyIiEoH+H0K0Rw9Uc4LzAAAAAElFTkSuQmCC">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## For the purpose of fitting, we restrict the latter to data points located above x = 0</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="c1">## Poisson weighting</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1">## initial guess best-fit parameters</span>
<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">SL_fit</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">'lm'</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span><span class="n">jac</span><span class="o">=</span><span class="n">DF</span><span class="p">,</span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">maxfev</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">chi_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">weights</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SL_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">popt</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">popt</span> <span class="c1">#to view the best fit parameters</span>
<span class="k">print</span> <span class="n">chi_sq</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 0.52750103  0.28882569  0.10191755  0.25905336  0.76540583  2.83343005]
0.00122093770376
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">xnew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y_fit</span> <span class="o">=</span> <span class="n">SL_fit</span><span class="p">(</span><span class="n">xnew</span><span class="p">,</span><span class="o">*</span><span class="n">popt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'ggplot'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xnew</span><span class="p">,</span> <span class="n">y_fit</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'best fit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">'r--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Arcseconds'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Normalized intensity'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-second-method-we-will-use-is-via-scipy.optimize.least_squares-.-With-this-module,-both-he-objective-function-and-jacobian-matrix-have-to-be-defined-differently-than-in-scipy.optimize.curve_fit-:">The second method we will use is via <strong><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html#scipy.optimize.least_squals">scipy.optimize.least_squares</a></strong> . With this module, both he objective function and jacobian matrix have to be defined differently than in <strong><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a></strong> :<a class="anchor-link" href="index.html#The-second-method-we-will-use-is-via-scipy.optimize.least_squares-.-With-this-module,-both-he-objective-function-and-jacobian-matrix-have-to-be-defined-differently-than-in-scipy.optimize.curve_fit-:">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">least_squares</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## objective function</span>
<span class="k">def</span> <span class="nf">Leastsquares</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
 <span class="n">w1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 <span class="n">w2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 <span class="n">w3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
 <span class="n">s1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
 <span class="n">s2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
 <span class="n">s3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
 <span class="n">model</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">w1</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="o">+</span><span class="n">w2</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span><span class="o">+</span><span class="n">w3</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w1</span><span class="o">-</span><span class="n">w2</span><span class="o">-</span><span class="n">w3</span><span class="p">))</span>
 <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="c1">## as you can see, in the objective function has to return the difference between the modelled data and data points</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## jacobian matrix</span>
<span class="k">def</span> <span class="nf">Jac</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
 <span class="n">w1</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 <span class="n">w2</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 <span class="n">w3</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
 <span class="n">s1</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
 <span class="n">s2</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
 <span class="n">s3</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
 <span class="n">dfw1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">dfw2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">dfw3</span> <span class="o">=</span>  <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
 <span class="n">dfs1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">dfs2</span> <span class="o">=</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">dfs3</span> <span class="o">=</span> <span class="n">w3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">s3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">([</span><span class="n">dfw1</span><span class="p">,</span><span class="n">dfw2</span><span class="p">,</span><span class="n">dfw3</span><span class="p">,</span><span class="n">dfs1</span><span class="p">,</span><span class="n">dfs2</span><span class="p">,</span><span class="n">dfs3</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## loading the data again:</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="c1">## Poisson weighting</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## calling the objective function and fitting data points</span>
<span class="n">res_leastsquares</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">Leastsquares</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">'lm'</span><span class="p">,</span><span class="n">jac</span><span class="o">=</span><span class="n">Jac</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">weights</span><span class="p">),</span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">max_nfev</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="c1">##computing the chi-square value</span>
<span class="n">chi_sq_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Leastsquares</span><span class="p">(</span><span class="n">res_leastsquares</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">weights</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## printing best-fit parameters</span>
<span class="k">print</span> <span class="n">res_leastsquares</span><span class="o">.</span><span class="n">x</span>
<span class="k">print</span> <span class="n">chi_sq_2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 0.52750174  0.28882527  0.10191733  0.2590536   0.76540736  2.83343784]
0.00122093770322
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-THIRD-method-we-will-use-is-via-scipy.optimize.leasq-,-which-is-pretty-similar-to-scipy.optimize.least_squares-except-for-the-saved-results-format">The THIRD method we will use is via <strong><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html">scipy.optimize.leasq</a></strong> , which is pretty similar to <strong><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html#scipy.optimize.least_squals">scipy.optimize.least_squares</a></strong> except for the saved results format<a class="anchor-link" href="index.html#The-THIRD-method-we-will-use-is-via-scipy.optimize.leasq-,-which-is-pretty-similar-to-scipy.optimize.least_squares-except-for-the-saved-results-format">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">leastsq</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## objective function</span>
<span class="k">def</span> <span class="nf">Leastsq</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
 <span class="n">w1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 <span class="n">w2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 <span class="n">w3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
 <span class="n">s1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
 <span class="n">s2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
 <span class="n">s3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
 <span class="n">model</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">w1</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="o">+</span><span class="n">w2</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span><span class="o">+</span><span class="n">w3</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w1</span><span class="o">-</span><span class="n">w2</span><span class="o">-</span><span class="n">w3</span><span class="p">))</span>
 <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">model</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="c1">##jacobian matrix same as in leastsquares method</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">res_leastsq</span> <span class="o">=</span> <span class="n">leastsq</span><span class="p">(</span><span class="n">Leastsq</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">weights</span><span class="p">),</span><span class="n">Dfun</span><span class="o">=</span><span class="n">Jac</span><span class="p">,</span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">maxfev</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">chi_sq_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Leastsq</span><span class="p">(</span><span class="n">res_leastsq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">weights</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">res_leastsq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="n">chi_sq_3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 0.52750103  0.28882569  0.10191755  0.25905336  0.76540583  2.83343005]
0.00122093770376
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-FOURTH-method-we-will-use-is-the-powerful-package-lmfit-.-LMFIT-has-the-advantage-of-fixing-certain-parameters-while-letting-others-unchanged,-and-the-possibiliy-to-introduce-bounds-on-the-variables.">The FOURTH method we will use is the powerful package <strong><a href="https://lmfit.github.io/lmfit-py/">lmfit</a></strong> . LMFIT has the advantage of fixing certain parameters while letting others unchanged, and the possibiliy to introduce bounds on the variables.<a class="anchor-link" href="index.html#The-FOURTH-method-we-will-use-is-the-powerful-package-lmfit-.-LMFIT-has-the-advantage-of-fixing-certain-parameters-while-letting-others-unchanged,-and-the-possibiliy-to-introduce-bounds-on-the-variables.">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">lmfit</span>
<span class="kn">from</span> <span class="nn">lmfit</span> <span class="kn">import</span> <span class="n">Minimizer</span><span class="p">,</span> <span class="n">minimize</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">,</span> <span class="n">report_fit</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## defining the objective function</span>
<span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
 <span class="n">w1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'omega1'</span><span class="p">]</span>
 <span class="n">w2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'omega2'</span><span class="p">]</span>
 <span class="n">w3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'omega3'</span><span class="p">]</span>
 <span class="n">s1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'sigma1'</span><span class="p">]</span>
 <span class="n">s2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'sigma2'</span><span class="p">]</span>
 <span class="n">s3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'sigma3'</span><span class="p">]</span>

 <span class="n">model</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">w1</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="o">+</span><span class="n">w2</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span><span class="o">+</span><span class="n">w3</span><span class="o">*</span><span class="n">Erfc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w1</span><span class="o">-</span><span class="n">w2</span><span class="o">-</span><span class="n">w3</span><span class="p">))</span>

 <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># using the class Parameters in which we can name the variables and assign first guess values and boundaries, if needed</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">'omega1'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">'omega2'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">'omega3'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">'sigma1'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">'sigma2'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">'sigma3'</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## fitting with lmfit via lmfit.minimize</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">lmfit</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">'leastsq'</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">weights</span><span class="p">),</span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">maxfev</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">## printing output</span>
<span class="n">report_fit</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[Variables]]
    omega1:   0.52750083 +/- 0.003494 (0.66%) (init= 0.3)
    omega2:   0.28882580 +/- 0.002845 (0.99%) (init= 0.3)
    omega3:   0.10191760 +/- 0.001193 (1.17%) (init= 0.3)
    sigma1:   0.25905329 +/- 0.001357 (0.52%) (init= 1)
    sigma2:   0.76540540 +/- 0.007152 (0.93%) (init= 2)
    sigma3:   2.83342789 +/- 0.047380 (1.67%) (init= 3)
[[Correlations]] (unreported correlations are &lt;  0.100)
    C(omega1, sigma2)            =  0.899 
    C(omega1, omega2)            = -0.895 
    C(omega1, sigma1)            =  0.889 
    C(omega3, sigma2)            = -0.870 
    C(omega3, sigma3)            = -0.853 
    C(omega2, sigma1)            = -0.851 
    C(sigma2, sigma3)            =  0.729 
    C(sigma1, sigma2)            =  0.716 
    C(omega2, sigma2)            = -0.632 
    C(omega1, omega3)            = -0.628 
    C(omega1, sigma3)            =  0.487 
    C(omega3, sigma1)            = -0.457 
    C(sigma1, sigma3)            =  0.348 
    C(omega2, omega3)            =  0.230 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="As-you-can-see,-the-output-is-much-nicer-with-lmfit,-where-uncertainties-are-displayed-along-the-best-fit-parameters,-as-well-as-the-correlation-coefficients-between-the-parameters.">As you can see, the output is much nicer with lmfit, where uncertainties are displayed along the best-fit parameters, as well as the correlation coefficients between the parameters.<a class="anchor-link" href="index.html#As-you-can-see,-the-output-is-much-nicer-with-lmfit,-where-uncertainties-are-displayed-along-the-best-fit-parameters,-as-well-as-the-correlation-coefficients-between-the-parameters.">¶</a>
</h4>
</div>
</div>
</div>
    </div>
  </div>

    </div>
    <aside class="postpromonav"><nav></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><footer id="footer"><p>Contents © 2020         <a href="mailto:fakahil92@gmail.com">Fatima Kahil</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
    
    
            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/moment-with-locales.min.js"></script><script src="../../assets/js/fancydates.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
