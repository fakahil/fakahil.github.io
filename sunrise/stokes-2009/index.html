<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Visualizing the IMAX (Sunrise 1) data points and the corresponding inverted STOKES profiles by SPINOR | Fatima Kahil</title>
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/poole.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/lanyon.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://fakahil.github.io/sunrise/stokes-2009/index.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Fatima Kahil">
<meta property="og:site_name" content="Fatima Kahil">
<meta property="og:title" content="Visualizing the IMAX (Sunrise 1) data points and the corresponding inv">
<meta property="og:url" content="https://fakahil.github.io/sunrise/stokes-2009/index.html">
<meta property="og:description" content="This code illustrates for each pixel on any of the inverted data of Sunrise 1 (cycle 177) the inverted Stokes profiles and the IMAX data points.
import numpy as np
import matplotlib.pyplot as plt
impo">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-09-12T16:30:30+01:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../blog/">Blog</a>
        <a class="sidebar-nav-item" href="../../journal/">Journal</a>
        <a class="sidebar-nav-item" href="../../coding/">Coding</a>
        <a class="sidebar-nav-item" href="../">Sunrise</a>
        <a class="sidebar-nav-item" href="../../solo/">Solar Orbiter</a>
        <a class="sidebar-nav-item" href="../../talks/">Talks &amp; Posters</a>
        <a class="sidebar-nav-item" href="../../teaching/">Teaching &amp; Outreach</a>
        <a class="sidebar-nav-item" href="../../arabic/">المدونة</a>
        <a class="sidebar-nav-item" href="../../about-me/">Contact</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://fakahil.github.io/" title="Fatima Kahil" rel="home">Fatima Kahil</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Visualizing the IMAX (Sunrise 1) data points and the corresponding inverted STOKES profiles by SPINOR</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Fatima Kahil</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="post-date published dt-published" datetime="2020-09-12T16:30:30+01:00" itemprop="datePublished" title="2020-09-12 16:30">2020-09-12 16:30</time></a></p>
        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>This code illustrates for each pixel on any of the inverted data of Sunrise 1 (cycle 177) the inverted Stokes profiles and the IMAX data points.</p>
<pre class="code python"><a name="rest_code_9c7069f653424387b906ff651615003d-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-3"></a><span class="kn">import</span> <span class="nn">pyfits</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-4"></a><span class="kn">import</span> <span class="nn">math</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-5"></a><span class="kn">import</span> <span class="nn">os</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-6"></a><span class="kn">import</span> <span class="nn">sys</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-7"></a><span class="n">lam_0</span> <span class="o">=</span> <span class="mf">5250.208</span> <span class="c1"># central wavelength</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-8"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-9"></a><span class="c1">#ind from 28 to 57</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-10"></a><span class="n">ind</span> <span class="o">=</span> <span class="s1">'030'</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-11"></a><span class="n">p2</span>  <span class="o">=</span> <span class="s1">'/home/kahil/sunrise_1/IMaX/Spinor1D_inversions_2016_Feb/'</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-12"></a><span class="n">dir_path</span> <span class="o">=</span> <span class="n">p2</span><span class="o">+</span><span class="s1">'Obs177_Cyc'</span><span class="o">+</span><span class="n">ind</span><span class="o">+</span><span class="s1">'/lev2.2_GlobSL0.120_936x936/'</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-13"></a><span class="n">wd</span> <span class="o">=</span> <span class="s1">'/home/kahil/kahil_data/project_1/for_thesis/'</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-14"></a><span class="c1">#os.mkdir(wd)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-15"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-16"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-17"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-18"></a><span class="n">wav</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">5249.808</span><span class="p">,</span><span class="mf">5250.808</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span> <span class="o">-</span> <span class="n">lam_0</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-19"></a><span class="n">del_lam2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">wav</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">wav</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">wav</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span><span class="n">wav</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">wav</span><span class="p">[</span><span class="mi">31</span><span class="p">]])</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-20"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-21"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-22"></a><span class="c1">#wav = np.arange(51) #wavelength points spanned by inversions or wav = np.linspace(5249.808,5250.808,51)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-23"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-24"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-25"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-26"></a><span class="c1">############################# stray light corrected imax</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-27"></a><span class="n">imax</span> <span class="o">=</span> <span class="n">pyfits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">dir_path</span><span class="o">+</span><span class="s1">'imax.fits'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-28"></a><span class="n">I_qs_t</span> <span class="o">=</span> <span class="p">(</span><span class="n">imax</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-29"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-30"></a><span class="c1">################################### best fit profiles returned by inversions</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-31"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-32"></a><span class="n">profs</span> <span class="o">=</span> <span class="n">pyfits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">dir_path</span><span class="o">+</span><span class="s1">'inverted_profs.1.fits'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-33"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-34"></a><span class="c1">####################################################physical parameters returned by inversions</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-35"></a><span class="n">inv_data</span> <span class="o">=</span> <span class="n">pyfits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">dir_path</span><span class="o">+</span><span class="s1">'inverted_atmos.fits'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-36"></a><span class="n">temp_logtm2p5</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">5</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-37"></a><span class="n">temp_logtm0p9</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">6</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-38"></a><span class="n">temp_logt0</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">7</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-39"></a><span class="n">B</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">8</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-40"></a><span class="n">Gamma</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">9</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-41"></a><span class="n">Az</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">10</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-42"></a><span class="n">V_LOS</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">11</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-43"></a><span class="n">Mu</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">12</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-44"></a><span class="n">B_LOS</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">13</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-45"></a><span class="n">Chi</span> <span class="o">=</span> <span class="n">inv_data</span><span class="p">[</span><span class="mi">14</span><span class="p">,:,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-46"></a><span class="n">C</span><span class="o">=</span><span class="n">pyfits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">'cont_inv_177_030.fits'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-47"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-48"></a><span class="c1">#######################################################</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-49"></a><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">618</span><span class="p">,</span><span class="mi">456</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">453</span><span class="p">,</span><span class="mi">734</span><span class="p">]))</span> <span class="c1">#np.where((B_LOS &gt; 200) &amp; (B_LOS &lt;500))    # scatter</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-50"></a><span class="n">points</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-51"></a><span class="c1">#i = int(raw_input('Enter x:'))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-52"></a><span class="c1">#j = int(raw_input('Enter y:'))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-53"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-54"></a><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-55"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-56"></a> <span class="n">i</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-57"></a> <span class="n">j</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-58"></a> <span class="n">I_qs</span><span class="o">=</span><span class="n">imax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-59"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-60"></a> <span class="n">I_lam</span> <span class="o">=</span> <span class="n">imax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">/</span><span class="n">I_qs</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-61"></a> <span class="n">Q_lam</span> <span class="o">=</span> <span class="n">imax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="n">I_qs</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-62"></a> <span class="n">U_lam</span> <span class="o">=</span> <span class="n">imax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span><span class="o">/</span><span class="n">I_qs</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-63"></a> <span class="n">V_lam</span><span class="o">=</span> <span class="n">imax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">3</span><span class="p">,:]</span><span class="o">/</span><span class="n">I_qs</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-64"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-65"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-66"></a> <span class="n">f</span> <span class="o">=</span> <span class="n">I_qs_t</span><span class="o">/</span><span class="n">I_qs</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-67"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-68"></a> <span class="n">Ip</span> <span class="o">=</span> <span class="n">I_lam</span><span class="o">+</span><span class="n">V_lam</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-69"></a> <span class="n">Im</span> <span class="o">=</span> <span class="n">I_lam</span><span class="o">-</span><span class="n">V_lam</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-70"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-71"></a> <span class="n">Prof_I</span> <span class="o">=</span> <span class="n">profs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="n">f</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-72"></a> <span class="n">Prof_V</span> <span class="o">=</span> <span class="n">profs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-73"></a> <span class="n">Prof_Q</span> <span class="o">=</span> <span class="n">profs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-74"></a> <span class="n">Prof_U</span> <span class="o">=</span> <span class="n">profs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">3</span><span class="p">,:]</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-75"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-76"></a> <span class="n">Prof_Ip</span> <span class="o">=</span> <span class="n">Prof_I</span><span class="o">+</span><span class="n">Prof_V</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-77"></a> <span class="n">Prof_Im</span> <span class="o">=</span> <span class="n">Prof_I</span><span class="o">-</span><span class="n">Prof_V</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-78"></a> <span class="n">csfont</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'fontname'</span><span class="p">:</span><span class="s1">'Comic Sans MS'</span><span class="p">}</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-79"></a> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-80"></a> <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-81"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">del_lam2</span><span class="p">,</span> <span class="n">I_lam</span><span class="p">,</span> <span class="s1">'kx'</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'IMaX'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-82"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span><span class="n">Prof_I</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'best fit'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-83"></a> <span class="c1">#ax1.plot(del_lam2,Ip,'rx',ms=10,mew=2)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-84"></a> <span class="c1">#ax1.plot(del_lam2, Im, 'bx',ms=10,mew=2)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-85"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-86"></a> <span class="c1">#ax1.plot(wav,Prof_Ip,'r')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-87"></a> <span class="c1">#ax1.plot(wav,Prof_Im,'b')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-88"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'$\Delta\lambda$'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-89"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Stokes I'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-90"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-91"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">minor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-92"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-93"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-94"></a> <span class="c1">#ax1.set_title('$B_{LOS}$ = '+str("%.1f" %B_LOS[i][j])+' G',fontsize=20)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-95"></a> <span class="c1">#ax1.legend(loc='lower right')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-96"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-97"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1.6</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-98"></a> <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-99"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-100"></a> <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-101"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">del_lam2</span><span class="p">,</span> <span class="n">V_lam</span><span class="p">,</span><span class="s1">'kx'</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'IMaX'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-102"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">Prof_V</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'best fit'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-103"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-104"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'$\Delta\lambda$'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-105"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Stokes V'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="o">**</span><span class="n">csfont</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-106"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-107"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">minor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-108"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-109"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-110"></a> <span class="c1">#ax2.set_title('$B_{LOS}$ = '+str("%.1f" %B_LOS[i][j])+' G',fontsize=20)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-111"></a> <span class="c1">#ax2.legend(loc='lower right')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-112"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-113"></a> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-114"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-115"></a> <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-116"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">del_lam2</span><span class="p">,</span> <span class="n">Q_lam</span><span class="p">,</span><span class="s1">'kx'</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'IMaX'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-117"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">Prof_Q</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'best fit'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-118"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-119"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'$\Delta\lambda$'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-120"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Stokes Q'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="o">**</span><span class="n">csfont</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-121"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-122"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">minor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-123"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-124"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-125"></a> <span class="c1">#ax3.set_title('$B_{LOS}$ = '+str("%.1f" %B_LOS[i][j])+' G',fontsize=20)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-126"></a> <span class="c1">#ax2.legend(loc='lower right')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-127"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-128"></a> <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-129"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-130"></a> <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-131"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">del_lam2</span><span class="p">,</span> <span class="n">U_lam</span><span class="p">,</span><span class="s1">'kx'</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'IMaX'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-132"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">Prof_U</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'best fit'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-133"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-134"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'$\Delta\lambda$'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-135"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Stokes U'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="o">**</span><span class="n">csfont</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-136"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-137"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">minor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-138"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'major'</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-139"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">'minor'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-140"></a> <span class="c1">#ax4.set_title('$B_{LOS}$ = '+str("%.1f" %B_LOS[i][j])+' G',fontsize=20)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-141"></a> <span class="c1">#ax2.legend(loc='lower right')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-142"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-143"></a> <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-144"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-145"></a> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">'$B_{LOS}$ = '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">%.1f</span><span class="s2">"</span> <span class="o">%</span><span class="n">B_LOS</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">+</span><span class="s1">' G'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span><span class="o">**</span><span class="n">csfont</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-146"></a><span class="c1">#plt.savefig(wd+'pixel'+str(j)+','+str(i))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-147"></a> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="s1">'pixel_local_'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-148"></a><span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-149"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-150"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-151"></a><span class="c1">############ computing the line core brightness image:</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-152"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-153"></a><span class="c1">#new_lc = np.zeros((936,936))</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-154"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-155"></a><span class="c1">#for i in range(936):</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-156"></a>  <span class="c1"># for j in range(936):</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-157"></a>    <span class="c1"># new_cont[i][j] =  (profs[i,j,0,:][0:10]).max()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-158"></a> <span class="c1">#     new_lc[i][j] =  (profs[i,j,0,:][15:25]).min()</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-159"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-160"></a><span class="c1">#hdu = pyfits.PrimaryHDU(new_lc)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-161"></a><span class="c1">#hdu.writeto('line_core_n_mean_QS_cont.fits')</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-162"></a>
<a name="rest_code_9c7069f653424387b906ff651615003d-163"></a><span class="c1">#line_core = new_lc*I_qs</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-164"></a><span class="c1">#hdu= pyfits.PrimaryHDU(line_core)</span>
<a name="rest_code_9c7069f653424387b906ff651615003d-165"></a><span class="c1">#hdu.writeto('line_core.fits')</span>
</pre>
</div>
    </div>
    <aside class="postpromonav"><nav></nav></aside></article><footer id="footer"><p>Contents © 2020         <a href="mailto:fakahil92@gmail.com">Fatima Kahil</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
    
    
            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/moment-with-locales.min.js"></script><script src="../../assets/js/fancydates.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
